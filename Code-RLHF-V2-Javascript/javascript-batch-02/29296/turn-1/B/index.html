<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Virtual Art Gallery</title>
<style>
body { margin: 0; overflow: hidden; }
#galleryCanvas { width: 100vw; height: 100vh; display: block; }
#startScreen, #infoOverlay { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0,0,0,0.7); color: white; padding: 20px; border-radius: 10px; display: none; }
#themeSelector { position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); }
</style>
</head>
<body>
<div id="startScreen">
    <h2>Welcome to the Virtual Gallery</h2>
    <p>Use WASD to move, mouse to look around. Click to teleport or view artwork details. Press 'E' for artwork info.</p>
    <button onclick="startGallery()">Enter Gallery</button>
    <select id="themeSelector" onchange="changeTheme(this.value)">
        <option value="modern">Modern</option>
        <option value="classic">Classic</option>
        <option value="abstract">Abstract</option>
    </select>
</div>
<div id="infoOverlay"></div>
<canvas id="galleryCanvas"></canvas>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/Tween.min.js"></script>
<script>
let scene, camera, renderer, controls, raycaster, artworks = [], currentTheme = 'modern';

function init() {
    scene = new THREE.Scene();
    camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    renderer = new THREE.WebGLRenderer({canvas: document.getElementById('galleryCanvas')});
    renderer.setSize(window.innerWidth, window.innerHeight);

    // Basic gallery setup
    const geometry = new THREE.BoxGeometry(100, 50, 100);
    const materials = {
        'modern': new THREE.MeshStandardMaterial({color: 0xffffff}),
        'classic': new THREE.MeshStandardMaterial({color: 0x8B4513}),
        'abstract': new THREE.MeshStandardMaterial({color: 0xFFD700})
    };
    const gallery = new THREE.Mesh(geometry, materials[currentTheme]);
    scene.add(gallery);

    // Lights
    const light = new THREE.AmbientLight(0x404040); // soft white light
    scene.add(light);
    const pointLight = new THREE.PointLight(0xffffff, 1, 100);
    pointLight.position.set(50, 25, 50);
    scene.add(pointLight);

    // Camera position
    camera.position.set(0, 10, 40);

    // Controls
    controls = new THREE.PointerLockControls(camera, document.body);
    scene.add(controls.getObject());

    // Raycaster for interaction
    raycaster = new THREE.Raycaster();

    // Artworks
    const artworkData = [
        {title: 'Sunset Over Sea', artist: 'Jane Doe', year: '2021', medium: 'Oil on Canvas'},
        {title: 'Urban Jungle', artist: 'John Smith', year: '2020', medium: 'Digital'},
        {title: 'Mystic Forest', artist: 'Alice Blue', year: '2019', medium: 'Watercolor'}
    ];
    const loader = new THREE.TextureLoader();
    artworkData.forEach((data, index) => {
        loader.load(`url_to_image_${index+1}.jpg`, function(texture) {
            const artGeometry = new THREE.PlaneGeometry(5, 7);
            const artMaterial = new THREE.MeshBasicMaterial({map: texture});
            const art = new THREE.Mesh(artGeometry, artMaterial);
            art.position.set(index * 15 - 15, 10, -49);
            art.userData = data;
            scene.add(art);
            artworks.push(art);
        });
    });

    // Event listeners for interaction
    document.addEventListener('click', onDocumentMouseClick);
    document.addEventListener('keydown', onDocumentKeyDown);

    animate();
}

function animate() {
    requestAnimationFrame(animate);
    TWEEN.update();
    controls.update();
    renderer.render(scene, camera);
}

function onDocumentMouseClick(event) {
    event.preventDefault();
    raycaster.setFromCamera(new THREE.Vector2(), camera);
    const intersects = raycaster.intersectObjects(scene.children);
    if (intersects.length > 0) {
        if (intersects[0].object !== scene) {
            showArtInfo(intersects[0].object);
        } else {
            teleport(intersects[0].point);
        }
    }
}

function onDocumentKeyDown(event) {
    if (event.key === 'e') {
        document.getElementById('infoOverlay').style.display = 'block';
    }
}

function showArtInfo(object) {
    const info = document.getElementById('infoOverlay');
    info.innerHTML = `<h3>${object.userData.title}</h3><p>By ${object.userData.artist}, ${object.userData.year}</p><p>${object.userData.medium}</p>`;
    info.style.display = 'block';
}

function teleport(position) {
    new TWEEN.Tween(controls.getObject().position)
        .to({x: position.x, y: position.y, z: position.z}, 500)
        .easing(TWEEN.Easing.Quadratic.InOut)
        .start();
}

function changeTheme(theme) {
    currentTheme = theme;
    // Here you would change the material of the gallery walls, floor, etc.
    // For brevity, this isn't fully implemented.
}

function startGallery() {
    document.getElementById('startScreen').style.display = 'none';
    controls.lock();
}

init();
</script>
</body>
</html>